library(devtools)
devtools::install_github("crsh/papaja")
devtools::install_github("crsh/papaja")
library(glue)
install.packages("glue")
devtools::install_github("crsh/papaja")
library("papaja", lib.loc="~/R/win-library/3.5")
library("papaja", lib.loc="~/R/win-library/3.5")
aaa3841_OpenData_withNA <- read.csv("~/GitHub(assignments)/midterm/midterm/aaa3841_OpenData_withNA.csv")
View(aaa3841_OpenData_withNA)
cue_prenap = aaa3841_OpenData_withNA$Cued_Prenap
cue_delay = aaa3841_OpenData_withNA$Cued_Delayed
uncue_prenap = aaa3841_OpenData_withNA$Uncued_Prenap
uncue_delay = aaa3841_OpenData_withNA$Uncued_Delayed
subjects = aaa3841_OpenData_withNA$Ppt.
mean_subject = c(cue_prenap, cue_delay, uncue_prenap, uncue_delay)
subjects_per_group = rep(subjects,4)
factor1 = c(rep("cue_prenap",40), rep("cue_delay", 40))
factor1
factor2 = c(rep("uncue_prenap",40), rep("uncue_delay", 40))
all_data = data.frame(subjects_per_group = as.factor(subjects_per_group), mean_subject, factor1, factor2)
aaa3841_OpenData_withNA <- read.csv("~/GitHub(assignments)/midterm/midterm/aaa3841_OpenData_withNA.csv")
View(aaa3841_OpenData_withNA)
all_data = data.frame(subjects_per_group = as.factor(subjects_per_group), mean_subject, factor1, factor2)
cue_prenap = aaa3841_OpenData_withNA$Cued_Prenap
cue_delay = aaa3841_OpenData_withNA$Cued_Delayed
uncue_prenap = aaa3841_OpenData_withNA$Uncued_Prenap
uncue_delay = aaa3841_OpenData_withNA$Uncued_Delayed
mean_subject = c(cue_prenap, cue_delay, uncue_prenap, uncue_delay)
subjects = rep(aaa3841_OpenData_withNA$Ppt.,4)
a <- rep(rep(c("A","B"), each = 2), 10)
b <- rep(c("A","B"),2)
a
b
a <- rep(rep(c("A","B"), 2), 10)
?rep
all_data = data.frame(subjects = as.factor(subjects), mean_subject, factor1, factor2)
all_data
View(all_data)
aov_out = aov(mean_subject~factor1*factor2, all_data)
summary(aov_out)
all_data = data.frame(subjects, mean_subject, factor1, factor2)
View(all_data)
aov_out = aov(mean_subject~factor1*factor2, all_data)
summary(aov_out)
all_data = data.frame(subjects = as.factor(subjects), mean_subject, factor1, factor2)
View(all_data)
class(subjects)
class(all_data$subjects)
Subj <- rep(1:10,each=4)
Factor1 <- rep(rep(c("A","B"), each = 2), 10)
Factor2 <- rep(rep(c("1","2"), 2), 10)
DV <- rnorm(40,0,1)
all_data2 <- data.frame(Subj = as.factor(Subj), DV,Factor1, Factor2)
View(all_data2)
subject_dv = c(cue_delay[1], cue_prenap[1], uncue_delay[1], uncue_prenap[1])
subject_dv = c(cue_delay[1:40], cue_prenap[1:40], uncue_delay[1:40], uncue_prenap[1:40])
subject_dv = for(i in 1:40){c(cue_delay[i], cue_prenap[i], uncue_delay[i], uncue_prenap[i])}
for(i in 1:40){subject_dv = c(cue_delay[i], cue_prenap[i], uncue_delay[i], uncue_prenap[i])}
subject_dv = for(i in 1:40){subject_dv = c(cue_delay[i], cue_prenap[i], uncue_delay[i], uncue_prenap[i])}
source('~/.active-rstudio-document')
subject_dv
rm(all_data2)
rm(Factor1)
rm(Factor2)
rm(Subj)
all_data = data.frame(subjects = as.factor(subjects), subject_dv, factor1, factor2)
all_data
View(all_data)
subjects = rep(1:40, each = 4)
all_data = data.frame(subjects = as.factor(subjects), subject_dv, factor1, factor2)
View(all_data)
aov_out = aov(subject_dv~factor1*factor2, all_data)
summary(aov_out)
levels(subjects)
is.factor(subjects)
cue_factor = rep(rep(c("C","U"), each = 2),10)
cue_factor = rep(rep(c("D","P"), each = 2),10)
uncue_factor = rep(rep(c("D","P"), each = 2),10)
all_data = data.frame(subjects = as.factor(subjects), subject_dv, cue_factor, uncue_factor)
View(all_data)
Subj <- rep(1:10,each=4)
Factor1 <- rep(rep(c("A","B"), each = 2), 10)
Factor2 <- rep(rep(c("1","2"), 2), 10)
DV <- rnorm(40,0,1)
all_data2 <- data.frame(Subj = as.factor(Subj), DV,Factor1, Factor2)
View(all_data2)
cue_factor = rep(rep(c("C","U"), 2),10)
cue_factor = rep(rep(c("C","U"), each = 2),10)
time_factor = rep(rep(c("D","P"), 2),10)
all_data = data.frame(subjects = as.factor(subjects), subject_dv, cue_factor, time_factor)
View(all_data)
aov_out = aov(subject_dv~cue_factor*time_factor)
aov_out = aov(subject_dv~cue_factor*time_factor, all_data)
summary(aov_out)
factor(subjects)
all_data = data.frame(subjects, subject_dv, cue_factor, time_factor)
aov_out = aov(subject_dv~cue_factor*time_factor, all_data)
summary(aov_out)
class(subjects)
as.factor(subjects)
class(subjects)
is.factor(subjects)
factor(subjects)
is.factor(subjects)
?factor
factor(as.character(subjects))
is.factor(subjects)
class(subjects)
is.factor(all_data$subjects)
as.character(subjects)
factor(subjects)
is.factor(subjects)
subjects = rep(as.character(aaa3841_OpenData_withNA$Ppt.), each = 4)
factor(subjects)
class(subjects)
as.factor(subjects)
all_data = data.frame(subjects = as.factor(subjects), subject_dv, cue_factor, time_factor)
View(all_data)
aov_out = aov(subject_dv~cue_factor*time_factor, all_data)
summary(aov_out)
sub = as.factor(subjects)
subjects = rep(aaa3841_OpenData_withNA$Ppt., each = 4)
sub = as.factor(subjects)
all_data = data.frame(sub, subject_dv, cue_factor, time_factor)
aov_out = aov(subject_dv~cue_factor, all_data)
summary(aov_out)
all_data2
View(all_data2)
means = c(mean(cue_prenap), mean(cue_delay), mean(uncue_prenap), mean(uncue_delay))
means
cue_delay
cue_prenap
?mean
means = c(mean(cue_prenap), mean(cue_delay, na.rm = TRUE), mean(uncue_prenap), mean(uncue_delay, na.rm = TRUE))
means
mean_matrix = as.matrix(means)
mean_matrix
?as.matrix
mean_matrix = as.matrix(means,2,2)
mean_matrix
mean_matrix = matrix(means,2,2)
mean_matrix
mean_matrix = matrix(means,2,2, byrow = TRUE)
mean_matrix
mean_matrix = matrix(means,2,2, byrow = TRUE, dimnames = c("cue", "delay"))
barplot(mean_matrix)
barplot(mean_matrix, beside= TRUE)
mean_matrix = matrix(means,2,2)
barplot(mean_matrix, beside= TRUE)
mean_matrix
barplot(mean_matrix, beside= TRUE, ylim= c(0,0.8))
devtools::install_github("crsh/papaja")
install.packages("devtools")
devtools::install_github("crsh/papaja")
library("papaja", lib.loc="~/R/win-library/3.5")
library("papaja", lib.loc="~/R/win-library/3.5")
library("devtools", lib.loc="~/R/win-library/3.5")
install.packages("pwr")
library("pwr", lib.loc="~/R/win-library/3.5")
library(pwr)
?pwr.anova.test
pwr.anova.test(k = 4, n = 40, f = 0.3, sig/sig.level = 0.05)
pwr.anova.test(k = 4, n = 40, f = 0.3, sig.level = 0.05)
pwr.anova.test(k = 4, n = 40, f = 0.112, sig.level = 0.05)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
knitr::kable(DV_analysis)
View(knitr::kable(DV_analysis))
View(DV_analysis)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
View(DV_analysis)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
View(DV_analysis)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
View(DV_analysis)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
View(DV_analysis)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
summary(aov_out)
subject_dv
cue_delay
View(all_data)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
View(all_data)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
summary(aov_out)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
barplot(mean_matrix, beside= TRUE, ylim= c(0,0.8))
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
eta_sq(aov_out)
install.packages("sjstats")
library("sjstats", lib.loc="~/R/win-library/3.5")
eta_sq(aov_out)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
summary(aov_out)
View(all_data)
aov_out = aov(subject_dv~cue_factor*time_factor+Error(sub/(cue_factor*time_factor)), all_data)
library(dplyr)
all_data %>%
filter(is.na(subject_dv)==TRUE)
unique(all_data %>%
filter(is.na(subject_dv)==TRUE))$sub
unique(as.numeric(all_data %>%
filter(is.na(subject_dv)==TRUE)))$sub
all_data %>%
filter(is.na(subject_dv)==TRUE)
nas <- all_data %>%
filter(is.na(subject_dv)==TRUE)
levels(nas$sub)
levels(as.factor(nas$sub))
as.factor(nas$sub)
nas$sub<-as.factor(nas$sub)
nas$sub
nas$sub<-as.factor(as.numeric(nas$sub))
nas
nas$sub
bad_subjects <- levels(nas$sub)
bad_subjects
clead_df <- all_data %>%
filter(sub %in% bad_subjects == FALSE)
clean_df <- all_data %>%
filter(sub %in% bad_subjects == FALSE)
clean_df
aov_out = aov(subject_dv~cue_factor*time_factor+Error(sub/(cue_factor*time_factor)), clean_df)
summary(aov_out)
a = summary(aov_out)
a
a[[1]]
class(a)
attributes(a)
a$`Error: sub:cue_factor:time_factor`
class(a$`Error: sub:cue_factor:time_factor`)
attributes(a$`Error: sub:cue_factor:time_factor`)
a$`Error: sub:cue_factor:time_factor`[[1]]
a$`Error: sub:cue_factor:time_factor`[[1]]$`Pr(>F)`
a$`Error: sub:cue_factor:time_factor`[[1]]$`Pr(>F)`[1]
a[[1]]
a[[3]]
a[[4]]
a[[4]][[1]]
a[[4]][[1]][2]
a[[4]][[1]][6]
a[[4]][[1]][5]
a[[4]][[1]][[5]]
a[[4]][[1]][[5]][1]
summary(aov_out)
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
eta_sq(aov_out)
library("sjstats", lib.loc="~/R/win-library/3.5")
eta_sq(aov_out)
eta_sq(aov_out)
# Graph of the means
library(sjstats)
eta_sq(aov_out)
summary(aov_out)
?eta_sq
eta_sq(aov_out, partial = FALSE)
eta_sq(aov_out, partial = TRUE)
print(model.tables(aov_out,"means"), format="markdown")
source('~/GitHub(assignments)/midterm/midterm/script_0403.R')
sim_power(.242)
power(effect_sizes, 0.242)
power(0.242)
# combine into dataframe
plot_df <- data.frame(effect_sizes,power)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
sim_power(.242)
power(0.242)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
?t.test
t.test(uncue_prenap, uncue_delay)
t.test(uncue_prenap, uncue_delay, paired=TRUE)
# function to run a simulated t-test
sim_power <- function(x){
A <- rnorm(n=38,mean=0, sd=1)
B <- rnorm(n=38,mean=(0+x), sd=1)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
length(cue_prenap)
sd(uncue_prenap)
sd(uncue_delay)
sd(uncue_delay, na.rm=TRUE)
# function to run a simulated t-test
sim_power <- function(x){
A <- rnorm(n=38,mean=0, sd=0.402)
B <- rnorm(n=38,mean=(0+x), sd=0.451)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
sim_power(0.242)
power(0.242)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
which(plot_df$power <= 0.05)
plot_df$power
which(plot_df$effect_sizes <= 0.05)
which(plot_df$effect_sizes >= 0.8)
plot_df$power[8]
which(plot_df$effect_sizes >= .112)
plot_df$power[2]
sim_power(.242)
power(.242)
plot_df <- data.frame(effect_sizes,power)
which(plot_df$effect_sizes >= .112)
# plot the power curve
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
plot_df$power[2]
sim_power(.242)
power(.242)
plot_df <- data.frame(effect_sizes,power)
which(plot_df$effect_sizes >= .112)
# plot the power curve
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
plot_df$power[2]
sim_power(0.242)
sim_power <- function(x){
A <- rnorm(n=38,mean=0, sd=0.402)
B <- rnorm(n=38,mean=(0+x), sd=0.451)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
sim_power <- function(x){
A <- rnorm(n=1000,mean=0, sd=0.402)
B <- rnorm(n=1000,mean=(0+x), sd=0.451)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
sim_power(0.242)
sim_power <- function(x){
A <- rnorm(n=100,mean=0, sd=0.402)
B <- rnorm(n=100,mean=(0+x), sd=0.451)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
sim_power(0.242)
power(0.242)
which(plot_df$effect_sizes >= .112)
plot_df$power[2]
sim_power(.242)
power(0.242)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
plot_df <- data.frame(effect_sizes,power)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
which(plot_df$effect_sizes >= .112)
plot_df$power[2]
sim_power <- function(x){
A <- rnorm(n=1000,mean=0, sd=0.402)
B <- rnorm(n=1000,mean=(0+x), sd=0.451)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
sim_power(0.242)
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
power(0.242)
plot_df <- data.frame(effect_sizes,power)
which(plot_df$effect_sizes >= .112)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
sim_power <- function(x){
A <- rnorm(n=100,mean=0, sd=0.402)
B <- rnorm(n=100,mean=(0+x), sd=0.451)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
sim_power(0.242)
power(0.242)
plot_df <- data.frame(effect_sizes,power)
which(plot_df$effect_sizes >= .112)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
plot_df$power[2]
sim_power <- function(x){
A <- rnorm(n=50,mean=0, sd=0.402)
B <- rnorm(n=50,mean=(0+x), sd=0.451)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
sim_power(0.242)
power(0.242)
plot_df <- data.frame(effect_sizes,power)
which(plot_df$effect_sizes >= .112)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
plot_df$power[2]
sim_power <- function(x){
A <- rnorm(n=38,mean=0, sd=0.402)
B <- rnorm(n=38,mean=(0+x), sd=0.451)
return(t.test(A,B,var.equal=TRUE, paired = TRUE)$p.value)
}
power <- sapply(effect_sizes,
FUN = function(x) {
sims <- replicate(1000,sim_power(x))
sim_power <- length(sims[sims<.05])/length(sims)
return(sim_power)})
plot_df <- data.frame(effect_sizes,power)
which(plot_df$effect_sizes >= .112)
library(ggplot2)
ggplot(plot_df, aes(x=effect_sizes,
y=power))+
geom_point()+
geom_line()
plot_df$power
plot_df$power[2]
